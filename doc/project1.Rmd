---
output:
  pdf_document: default
  html_document: default
---
---
title: "How the outbreak of COVID-19 influence popular vote?"
author: "Weiwei Song"
date: "1/22/2021"
output: pdf_document

## R Markdown
Back in February of 2020, the world situation is completely different. At that time, the unemployment rate in the United States was the lowest in decades, the stock market repeatedly hit record highs, and the situation of President Trump's re-election was very good. However, the COVID-19 pandemic changed this situation dramatically. Many people say that Trump's response to coronavirus is one of the main reason he failed in the election. Is that true?The count of everyone's ballot is called the popular vote. Under the model "Time For Change" model created by Professor Alan Abramowitz.Presidential elections can be predicted with Presidential approval ratings, economic growth and how long the White House has been controlled by one party instead of the other. The last factor can be ignored.Let's use the survey data to do an analysis whether coronavirus is a important indicator when people make their choice in the future "president". 

```{r include=FALSE}
library(tidyverse)
anes_pilot_2020<-
  read_csv("../data/anes_pilot_2020ets_csv.csv")
#clear all missing data, and rename the variable 
#Make question form=1, if asked about covid; form=2, healthcare
trump_data <- anes_pilot_2020%>%
      select(apppres7:healthcarepres7,covid_inf=covid1,covid_eco=covid2)%>%
      na_if(99)%>%
      na_if(9)%>%
      rename(Job=apppres7,relation=frnpres7,immgration=immpres7,economy=econpres7,covid=covidpres7,healthcare=healthcarepres7)%>%
  na_if(77)%>%
  mutate(Form=if_else(covid==88,2,1))%>%
  na_if(88)%>%
  mutate(Answer=coalesce(covid,healthcare))%>%
  select(-covid,-healthcare)%>%
  drop_na()
number_row<-nrow(trump_data)
```




```{r echo=FALSE}
graph_data<-trump_data%>%
  select(-Form,-covid_inf,-covid_eco)%>%
  gather()%>%
  group_by(value)%>%
  count(key)%>%
  mutate(prop=n/number_row)%>%
  ungroup()
ggplot(graph_data,aes(key,prop,fill=factor(value)))+
  geom_col(position="fill",width=0.7)+
  theme_classic()+
  scale_x_discrete(labels=c("Healthcare/COVID","Economy","Immigration","Job","Relation"))+
  scale_fill_brewer(palette = "Greens",name="Levels",labels=c("Approve extremly","Approve moderately","Approve Slightly","Neither","Disapprove sligtly","Disapprove moderately","Disapprove extremely"))+
  coord_flip()+
  theme(axis.title.x=element_text(size=5,face = "bold"),legend.title = element_text(size = 5,face = "bold"), legend.text = element_text(size = 5))+
  labs(title="Trump's Job approval in seven levels",x="",y="")
```

```{r include=FALSE}
g_data<-graph_data%>%
  filter(!value %in% 4)%>%
  mutate(attitude=if_else(value<4,"Approve","Disapprove"))%>%
  group_by(key,attitude)%>%
  summarise(prop1=sum(n)/number_row)
```

```{r echo=FALSE}
ggplot(g_data,aes(key,prop1,fill=factor(attitude),label=signif(prop1*100,2)))+
  geom_col(position="stack",width=0.7)+
  theme_minimal()+
  scale_x_discrete(name="",labels=c("Healthcare/COVID","Economy","Immigration","Job","Relation"))+
  scale_fill_brewer(name="",labels=c("Approve ","Disapprove"))+
  geom_text(size = 3, position = position_stack(vjust = 0.5)) +
  coord_flip()
#why economics disapprove rate lowest , back to April 2020, 

```  
# let's see whether the two form of questionnaires in terms of Trump's job approval rating in the health care or Covid-19 have basically same distribution. 
# I don't know if the test of homegency using chi-sqare test here will be appropriate, but let's give a try 
# first visualize the comparism 
```{r echo=FALSE}
data1<-trump_data%>%
  select(Form, Answer)%>%
  group_by(Form)%>%
  count(Answer)%>%
  mutate(total=sum(n),prop=n/total)
ggplot(data1,aes(Answer,prop,fill=factor(Form)))+
  geom_col(position="dodge")+
  theme_classic()+
  labs(main="Comparing results of two form of questions", subtitle="Form=1,include covid, Form=2,include health care",x="Answer",y="Frequency", fill="Form")
# a rough conclusion based on the graph, will be the differnce is not big, however, for answer=4, which is "either disapprove nor approve", the difference is quite big.Why? Does that possibly mean that people's concern about covid-19 is not only mean the huge burden to medical support but also the effect to economy: increase un employment rate?Or maybe don't worried about get infected but more worried about losing their job?
```

#
```{r echo=FALSE,message=FALSE}
b<-trump_data%>%
  select(covid_inf,covid_eco)%>%
  gather()

ggplot(b,aes(value,fill=key))+
  geom_bar(position="dodge")
#among all survey population, people are more concerned with economy effects 
# trump_data%>%
#   select(economy,Answer,covid_inf,covid_eco)%>%
#   filter(economy>4)%>%
#   group_by(covid_eco)%>%
#   count(covid_eco)%>%
#   ungroup()%>%
#   mutate(prop=n/sum(n))
# 
# trump_data%>%
#   select(economy,Answer,covid_inf,covid_eco)%>%
#   filter(economy>4)%>%
#   group_by(covid_inf)%>%
#   count(covid_inf)%>%
#   ungroup()%>%
#   mutate(prop=n/sum(n))
# 
# trump_data%>%
#   select(economy,Answer,covid_inf,covid_eco)%>%
#   filter(Answer>4)%>%
#   group_by(covid_inf)%>%
#   count(covid_inf)%>%
#   ungroup()%>%
#   mutate(prop=n/sum(n))
# 
# trump_data%>%
#   select(economy,Answer,covid_inf,covid_eco)%>%
#   filter(Answer>4)%>%
#   group_by(covid_eco)%>%
#   count(covid_eco)%>%
#   ungroup()%>%
#   mutate(prop=n/sum(n))
  
  

#Q3:People who are worried abount coronavirus will support who among Trump and Biden?








  
```
There are two differnt wording in terms of healthcare or Covid-19, let's check if the two different working influence people'answer related to this question.
FORM = 1: 
Do you approve, disapprove, or neither approve nor disapprove of the way Donald Trump is handing the coronavirus(COVID-19)outbreak?
FORM = 2: 
Do you approve, disapprove, or neither approve nor disapprove of the way Donald Trump is handling health care?

we need to test the hypothesis whether for a random people in the survey group, whether the two question actually ask the same topic for them. In another word, the variable covid and healthcare follow the same distribution 


The p value is essentially zero, which doesn't give us enough evidence that the two wording techniques doesn't influence people's answer. People who answered question form 1 have less people hold neutral attitude.This makes sense because for majority of people, Trump's job performance regarding to coronavirus's outbreak in USA may not equal to what he did with heath care system. People may complains about the Trump's error in dealing with COVID-19 but they may find that his policy about health care system is acceptable. 
Overall, large percentage of citizens do disapprove extremely strongly about what Trump did to health care and COVID-19. 

Is there any possibilities that people's concern about coronavirus and healthcare system really influence their choice? 

 not that worried about themselves, but more worried about economy. 

Is people's understanding or the information media gives to them affect their option about the coronavirus?


